<?xml version="1.0"?>
<launch>
  <arg name="use_sim_time" default="true"/>
  <arg name="hokuyo_scan_topic" default="/hokuyo_scan"/>
  <arg name="odom_topic" default="/odom"/>
  <arg name="imu_topic" default="/imu"/>
  <arg name="fusion_odom_topic" default="/fusion/odom"/>
  <arg name="world_file_path" default="$(find-pkg-share orange_gazebo)/worlds/orange_igvc.world"/>
  <arg name="xacro_file_path" default="$(find-pkg-share orange_description)/xacro/orange_robot_simulation.xacro"/>
  
  <!-- robot_localization -->
  <include file="$(find-pkg-share orange_sensor_tools)/launch/localization.launch.xml">
    <arg name="use_sim_time" value="$(var use_sim_time)"/>
    <arg name="odom_in" value="$(var odom_topic)"/>
    <arg name="imu_in" value="$(var imu_topic)"/>
    <arg name="fusion_odom_out" value="$(var fusion_odom_topic)"/>
  </include>
  
  <!-- gzserver -->
  <include file="$(find-pkg-share gazebo_ros)/launch/gzserver.launch.py">
    <arg name="use_sim_time" value="$(var use_sim_time)"/>
    <arg name="world" value="$(var world_file_path)"/>
  </include>
  
  <!-- gzclient -->
  <include file="$(find-pkg-share gazebo_ros)/launch/gzclient.launch.py">
    <arg name="use_sim_time" value="$(var use_sim_time)"/>
  </include>
  
  <!-- robot_state_publisher -->
  <node pkg="robot_state_publisher" exec="robot_state_publisher">
    <param name="use_sim_time" value="$(var use_sim_time)"/>
    <param name="robot_description" value="$(command 'xacro $(var xacro_file_path)')"/>
  </node>
  
  <!-- spawn_entity -->
  <!-- Spawn at origin facing WEST (180deg = 3.14159rad = -X direction) -->
  <!-- This is 180 degrees from default (EAST), facing toward the course -->
  <node pkg="gazebo_ros" exec="spawn_entity.py" args="-entity orange_robot -topic /robot_description -x 0.0 -y 0.0 -z 0.1 -Y 3.14159">
    <param name="use_sim_time" value="$(var use_sim_time)"/>
  </node>
</launch>
